<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Test componente</title>
<script type="text/javascript"
	src="https://code.jquery.com/jquery-2.2.0.js"></script>
	
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/qtip2/2.2.1/basic/jquery.qtip.js"></script>
<script type="text/javascript" src="../js/libs/cytoscape.js"></script>
<script type="text/javascript" src="../js/libs/dagre.js"></script>
<script type="text/javascript" src="../js/libs/cytoscape-dagre.js"></script>

<script type="text/javascript" src="../js/libs/cytoscape-qtip.js"></script>
<script type="text/javascript" src="../js/ii.sparql.main.js"></script>
<script type="text/javascript" src="../js/ii.sparql.util.js"></script>
<script type="text/javascript" src="../js/ii.sparql.format.graph.js"></script>
<script type="text/javascript" src="../js/ii.cytoscape.js"></script>
<script type="text/javascript" src="../js/libs/sparqljs/sparqljs-browser.js"></script>




<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/qtip2/2.2.1/basic/jquery.qtip.css" >

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">
<style>
.ii-graph-legend-container {
	background-color: #F8F9FA !important;
}
.legend-circle-node{
	width: 30px;
	height: 30px;
	-moz-border-radius: 50px;
	-webkit-border-radius: 50px;
	border-radius: 50px;
}

.legend-arrow-line {
	width: 30px;
	height: 8px;
}

.ii-graph-legend-container{
     background:white;
     float:left;
     z-index:999;
     position:relative;
     border:1px solid #CCC;
}
.ii-graph-legend{
     width:300px;
}

.ii-graph-legend-actions-list{
   margin-top:30px;

}
.ii-graph-legend-action i{
   font-size:30px; 
   padding-left:20px;
}

.container-graph-full-screen{
   position:fixed;
   left:0px;
   width:100%;
   height:100%;
   background:#F8F9FA;
   z-index:50;
}

.legend-graph-full-screen{
    //position:fixed;
    //bottom:0px;
   margin:10px;
}

.graph-full-screen{
     height:100%;
}



</style>

</head>
<body>


	<script type="text/javascript">

 var smwQueryPrefixes = window.smwQueryPrefixes = [];
 smwQueryPrefixes.push({
 	pre : 'ii-app-m',
 	ns : 'http://www.imolinfo.it/ontologie/ea/v1/ii-application-domain-model#'
 });
 smwQueryPrefixes.push({
 	pre : 'ii-overall-m',
 	ns : 'http://www.imolinfo.it/ontologie/ea/v2/ii-overall-model#'
 });
 smwQueryPrefixes
 		.push({
 			pre : 'abi-app',
 			ns : 'http://www.imolinfo.it/ontologie/abi-lab/v3/abilab_tassonomia_applicativa#'
 		});
 smwQueryPrefixes
 		.push({
 			pre : 'abi-inf',
 			ns : 'http://www.imolinfo.it/ontologie/abi-lab/v4/abilab_tassonomia_infrastrutturale#'
 		});
 smwQueryPrefixes
 		.push({
 			pre : 'abi-proc',
 			ns : 'http://www.imolinfo.it/ontologie/abi-lab/v2/abilab_tassonomia_processi#'
 		});
 smwQueryPrefixes.push({
 	pre : 'ent-m',
 	ns : 'http://www.imolinfo.it/ontologie/ea/v2/enterprise-domain-model#'
 });
 smwQueryPrefixes.push({
 	pre : 'skos',
 	ns : 'http://www.w3.org/2004/02/skos/core#'
 });
 smwQueryPrefixes.push({
 	pre : 'foaf',
 	ns : 'http://xmlns.com/foaf/0.1/'
 });
 smwQueryPrefixes.push({
 	pre : 'project-domain-model',
 	ns : 'http://www.imolinfo.it/ontologie/v2/project-domain-model#'
 });
 smwQueryPrefixes.push({
 	pre : 'rdf',
 	ns : 'http://www.w3.org/1999/02/22-rdf-syntax-ns#'
 });
 smwQueryPrefixes.push({
 	pre : 'rdfs',
 	ns : 'http://www.w3.org/2000/01/rdf-schema#'
 });
 smwQueryPrefixes.push({
 	pre : 'ii-bus-m',
 	ns : 'http://www.imolinfo.it/ontologie/ea/v1/ii-business-model#'
 });
 smwQueryPrefixes.push({
 	pre : 'ubi-overall-m',
 	ns : 'http://www.ubibanca.com/ontologies/ea/v1/ubi-overall-model#'
 });
 smwQueryPrefixes.push({
 	pre : 'ii-inf-m',
 	ns : 'http://www.imolinfo.it/ontologie/ea/v1/ii-infrastructure-model#'
 });
    $(document).ready(function() {
        /*var config={};
        config.divId="mynetwork"
        config.divStyle="width:100%;height:530px;"
        config.endpoint= "https://ubiss-test.imolinfo.it/fuseki/dsread/query"
        config.sparql = $("#"+config.divId).attr("sparql-query");
		config.queryPrefixes=smwQueryPrefixes;
        //config.sparqlWithPrefixes=spqlib.util.addPrefixes(config.sparql,window.smwQueryPrefixes);
        config.nodeConfiguration=[{ category:"Business Process",nodeColor:"#000000"},{ category:"Informatic Resource",nodeColor:"#000000", image:"https://ubiss-test.imolinfo.it/eap/images/0/02/Governance_icon.png"},{ category:"Application",nodeColor:"#00FF00", image:"https://ubiss-test.imolinfo.it/eap/images/c/c1/Application_icon.png"},{ category:"Application Component",nodeColor:"#FFF700", image:"https://ubiss-test.imolinfo.it/eap/images/f/f0/Software_component_icon.png"},{ category:"Virtual Host",nodeColor:"#0400FF", image:"https://ubiss-test.imolinfo.it/eap/images/c/c1/Virtual_Host_icon.png"},{ category:"Physical Host",nodeColor:"#FF0000"},{ category:"Cluster",nodeColor:"#FF00EB"}]
        config.edgeConfiguration={}
        config.rootElement="Hsapcdg05";
        config.rootElementColor=""
        config.rootElementImage="https://ubiss-test.imolinfo.it/eap/images/0/09/Target.png"
        config.showLegend="true";
        config.legendConfiguration={show:"true",expandable:"true",expanded:"true"};
        config.defaultNodeColor="#CCC";
        config.defaultEdgeColor="#CCC";
        config.minZoom=0.2
        config.maxZoom=1.2
        config.linkBasePath="https://ubiss-test.imolinfo.it/eap/index.php/";
        config.layout="dagre";
        config.maxLabelLength=30;
        config.spinnerImagePath=config.linkBasePath+"../resources/src/jquery/images/spinner-large.gif";
        config.layoutOptions = "{rankSep:150}";
        config.nodeStyle = {};
        config.edgeStyle = {};
        config.basicAuthBase64String="YWRtaW46YmNlMjYz";
        spqlib.sparql2Graph(config);*/
        

    });

    $(document).ready(function() {
        
        /*config2.maxZoom=
        config2.spinnerImagePath=config2.linkBasePath+"../resources/src/jquery/images/spinner-large.gif";
        //spqlib.util.doQuery(config2.endpoint, config2.sparqlWithPrefixes, renderTable, config2);
		spqlib.sparql2Table(config2);*/
       /* var $sortableTables = $('#mynetwork-table').find( 'table.sortable' );
        if ( $sortableTables.length ) {    
               mw.loader.using( 'mediawiki.util' ).done( function () {        
                     $sortableTables.tablesorter();    } );}*/
    });
    
    

    $(document).ready(function() {
    	/*var config3={};
    	config3.divId="mynetwork-taxonomy"
    	config3.divStyle="width:100%;height:530px;"
    	config3.endpoint= "https://ubiss-test.imolinfo.it/fuseki/dsread/query"
    	config3.sparql = $("#"+config3.divId).attr("sparql-query")
    	config3.queryPrefixes=smwQueryPrefixes;
        //config3.sparqlWithPrefixes=spqlib.util.addPrefixes(config3.sparql,window.smwQueryPrefixes);
    		config3.nodeConfiguration=[{ category:"Business Process",nodeColor:"#000000"},{ category:"Informatic Resource",nodeColor:"#000000", image:"https://ubiss-test.imolinfo.it/eap/images/0/02/Governance_icon.png"},{ category:"Application",nodeColor:"#00FF00", image:"https://ubiss-test.imolinfo.it/eap/images/c/c1/Application_icon.png"},{ category:"Application Component",nodeColor:"#FFF700", image:"https://ubiss-test.imolinfo.it/eap/images/f/f0/Software_component_icon.png"},{ category:"Virtual Host",nodeColor:"#0400FF", image:"https://ubiss-test.imolinfo.it/eap/images/c/c1/Virtual_Host_icon.png"},{ category:"Physical Host",nodeColor:"#FF0000"},{ category:"Cluster",nodeColor:"#FF00EB"}]
    		config3.edgeConfiguration={}
    		config3.rootElement="Hsapcdg05";
    		config3.rootElementColor=""
    			config3.rootElementImage="https://ubiss-test.imolinfo.it/eap/images/0/09/Target.png"
    				config3.showLegend="true";
    		config3.defaultNodeColor="#CCC";
    		config3.defaultEdgeColor="#CCC";
    		config3.minZoom=0.2
    		config3.maxZoom=1.2
    		config3.linkBasePath="https://ubiss-test.imolinfo.it/eap/index.php/";
    		config3.layout="dagre";
    		config3.maxLabelLength=30;
    		config3.spinnerImagePath=config3.linkBasePath+"../resources/src/jquery/images/spinner-large.gif";
    		config3.layoutOptions = "{rankSep:150}";
    		config3.nodeStyle = {shape:'roundrectangle', width:120, height:80,'text-valign': 'center','text-halign': 'center','border-color' : '#000','border-width' : 1};
    		config3.edgeStyle = {'target-arrow-shape':''};
			config3.basicAuthBase64String="YWRtaW46YmNlMjYz";

        spqlib.sparql2Graph(config3);*/
    });



    $(document).ready(function() {
        var config4={};
        config4.divId="mynetwork-host"
        config4.divStyle="width:100%;height:530px;"
        config4.endpoint= "https://ubiss-test.imolinfo.it/fuseki/dsread/query"
        config4.sparql = $("#"+config4.divId).attr("sparql-query")
	 config4.queryPrefixes=smwQueryPrefixes;
        //config4.sparqlWithPrefixes=addPrefixes(config.sparql)
        config4.nodeConfiguration=[{ category:"Business Process",nodeColor:"#000000",image:"https://ubiss-test.imolinfo.it/eap/images/d/db/Business-process.png"},{ category:"Informatic Resource",nodeColor:"#000000", image:"https://ubiss-test.imolinfo.it/eap/images/0/02/Governance_icon.png"},{ category:"Application",nodeColor:"#00FF00", image:"https://ubiss-test.imolinfo.it/eap/images/c/c1/Application_icon.png"},{ category:"Application Component",nodeColor:"#FFF700", image:"https://ubiss-test.imolinfo.it/eap/images/f/f0/Software_component_icon.png"},{ category:"Virtual Host",nodeColor:"#0400FF", image:"https://ubiss-test.imolinfo.it/eap/images/c/c1/Virtual_Host_icon.png"},{ category:"Physical Host",nodeColor:"#FF0000",image:"https://ubiss-test.imolinfo.it/eap/images/7/7a/Physical_host.png"},{ category:"Cluster",nodeColor:"#FF00EB",image:"https://ubiss-test.imolinfo.it/eap/images/7/7d/Cluster.png"}]
        config4.edgeConfiguration={}
        config4.rootElement="As400";
        config4.rootElementImage="https://ubiss-test.imolinfo.it/eap/images/0/09/Target.png"
        config4.showLegend="true";
        config4.defaultNodeColor="#CCC";
        config4.defaultEdgeColor="#CCC";
        config4.minZoom=0.2
        config4.maxZoom=1.2
        config4.linkBasePath="https://ubiss-test.imolinfo.it/eap/index.php/";
        config4.layout="dagre";
        config4.spinnerImagePath=config4.linkBasePath+"../resources/src/jquery/images/spinner-large.gif";
config4.basicAuthBase64String="YWRtaW46YmNlMjYz";

        var layoutOptions = "{rankSep:150}";
                if (layoutOptions=="non presente"){
                    config4.layoutOptions={};
                } else {
                    config4.layoutOptions=JSON.parse(JSON.stringify({rankSep:150}));
                }
                                spqlib.sparql2Graph(config4);
    });

    
</script>
	<!-- <div id="mynetwork-container" class="cytoscape-graph-container">
		<div id="mynetwork-legend-container"
			class="cytoscape-legend-container">
			<div class="cytoscape-legend" id="mynetwork-legend"></div>
			<div class="cytoscape-actions-list">
				<div class="cytoscape-action">
					<a href="#" onclick="javascript:toggleFullScreen('mynetwork');"><i
						class="glyphicon glyphicon-fullscreen"></i>
					<spac class="fullscreen-label" style="padding-left:10px;">Go
						fullscreen</span></a>
				</div>
		</div> -->
		<!--legend container-->
		<div id="mynetwork" class="cytoscape-graph"
			style="width: 100%; height: 530px;"
			sparql-query="SELECT  ?parent_uri ?parent_name ?child_uri ?child_name ?parent_type_uri ?parent_type ?child_type_uri ?child_type ?relation_uri ?relation_name
WHERE
{
  {
    VALUES ?root_name {&quot;Hsapcdg05&quot;}
    ?comp rdf:type ii-app-m:ApplicationComponent.
    ?comp rdf:type ?comp_type.
    ?comp_type rdfs:label ?parent_type.
    ?comp ii-overall-m:runsOnHost ?host.
    ?comp ?relation ?host.
    ?comp rdfs:label ?comp_label.
    ?host rdfs:label ?host_label.
    ?host rdfs:label ?root_name.
    ?host rdf:type ?host_type.
    ?host_type rdfs:label ?child_type.
    ?relation rdfs:label ?relation_name.
    BIND (concat(?comp_label) AS ?parent_name).
    BIND (concat(?host_label) AS ?child_name).
    BIND (?comp AS ?parent_uri)
    BIND (?host AS ?child_uri)
    BIND (ii-app-m:ApplicationComponent AS ?parent_type_uri)
    BIND (?host_type AS ?child_type_uri)
    BIND (ii-overall-m:runsOnHost AS ?relation_uri)

} UNION 
  { 
         VALUES ?root_name {&quot;Hsapcdg05&quot;}
    ?app rdf:type ii-app-m:Application.
    ?app rdf:type ?app_type.
    ?app_type rdfs:label ?app_type_label.
    ?app ii-app-m:isComposedByComponent ?comp.
    ?app ?relation ?comp.
    ?relation rdfs:label ?relation_name.
    ?comp rdfs:label ?comp_label.
    ?comp rdf:type [rdfs:label ?comp_type_label].
    ?app rdfs:label ?app_label.
    ?comp ii-overall-m:runsOnHost ?host.
    ?host rdfs:label ?host_label.
    ?host rdfs:label ?root_name.
    BIND (concat(?app_type_label) AS ?parent_type).
    BIND (concat(?comp_type_label) AS ?child_type).
    BIND (concat(?app_label) AS ?parent_name).
    BIND (concat(?comp_label) AS ?child_name).
    BIND (?app AS ?parent_uri).
    BIND (?comp AS ?child_uri).
    BIND (ii-app-m:Application AS ?parent_type_uri).
    BIND (ii-app-m:ApplicationComponent AS ?child_type_uri).
    BIND (?relation AS ?relation_uri).
  }
UNION
  {
 ?ir rdf:type ubi-overall-m:InformaticResource.
    ?ir rdf:type [rdfs:label ?ir_type_label].
    VALUES ?root_name {&quot;Hsapcdg05&quot;}
    ?ir ubi-overall-m:containsApplication ?app.
    ?app rdf:type [rdfs:label ?app_type_label].
    ?ir ?relation ?app.
    ?relation rdfs:label ?relation_name.
    ?ir rdfs:label ?ir_label.
    ?app rdfs:label ?app_label.
    ?ir ubi-overall-m:containsApplication ?app.
    ?app ii-app-m:isComposedByComponent ?comp.
    ?comp ii-overall-m:runsOnHost ?host.
    ?host rdfs:label ?host_label.
    ?host rdfs:label ?root_name.
    BIND (concat(?ir_type_label) AS ?parent_type).
    BIND (concat(?app_type_label) AS ?child_type).
    BIND (concat(?ir_label) AS ?parent_name).
    BIND (concat(?app_label) AS ?child_name).
    BIND (?ir AS ?parent_uri).
    BIND (?app AS ?child_uri).
    BIND (ubi-overall-m:InformaticResource AS ?parent_type_uri).
    BIND (ii-app-m:Application AS ?child_type_uri).
    BIND (?relation AS ?relation_uri).
  } 
}"></div>


<div id="mynetwork-taxonomy" class="cytoscape-graph" style="width:100%;height:530px;" sparql-query="
SELECT distinct ?parent_uri ?parent_name ?child_uri ?child_name ?parent_type_uri ?parent_type ?child_type_uri ?child_type ?relation_uri ?relation_name WHERE { 
GRAPH <http://www.ubibanca.com/ontologie/ea-wiki/ubi-wiki-instances-graph> { 
{
	?child_uri abi-app:haClassificazioneApplicativaABILab ?parent_uri.
	?parent_uri rdfs:label ?parent_name.
	?child_uri rdfs:label ?child_name.
	?parent_uri rdf:type ?parent_type_uri.
	?parent_type_uri rdfs:label ?parent_type.
	?child_uri rdf:type ?child_type_uri.
	?child_type_uri rdfs:label ?child_type.
	values ?root_name {&quot;Governo e Monitoraggio&quot;}
	?child_uri rdfs:label ?root_name.
	 abi-app:haClassificazioneApplicativaABILab rdfs:label ?relation_name.
	      BIND (abi-app:haClassificazioneApplicativaABILab AS ?relation_uri).
} UNION {
	?child_uri abi-app:haClassificazioneApplicativaABILab ?parent_uri.
	?parent_uri rdfs:label ?parent_name.
	?child_uri rdfs:label ?child_name.
	?parent_uri rdf:type ?parent_type_uri.
	?parent_type_uri rdfs:label ?parent_type.
	?child_uri rdf:type ?child_type_uri.
	?child_type_uri rdfs:label ?child_type.
	values ?root_name {&quot;Governo e Monitoraggio&quot;}
	?parent_uri rdfs:label ?root_name.
	 abi-app:haClassificazioneApplicativaABILab rdfs:label ?relation_name.
	      BIND (abi-app:haClassificazioneApplicativaABILab AS ?relation_uri).
}
 } }"></div>

<div id="mynetwork-host-container" style="width:100%;height:530px;">
<div id="mynetwork-host" class="cytoscape-graph"  sparql-query="SELECT distinct
?parent_uri ?parent_name ?child_uri ?child_name ?parent_type_uri ?parent_type  ?child_type_uri ?child_type ?relation_uri ?relation_name
WHERE
{
  {
    #dai componenti agli host
    VALUES ?root_name {&quot;As400&quot;}
    ?comp rdf:type ii-app-m:ApplicationComponent.
    ?comp rdf:type ?comp_type.
    ?comp_type rdfs:label ?parent_type.
    ?comp ii-overall-m:runsOnHost ?host.
    ?comp ?relation ?host.
    ?comp rdfs:label ?comp_label.
    ?host rdfs:label ?host_label.
    ?host rdfs:label ?root_name.
    ?host rdf:type ?host_type.
    ?host_type rdfs:label ?child_type.
    ?relation rdfs:label ?relation_name.
     BIND (?relation  AS ?relation_uri ).
    BIND (?comp AS ?parent_uri).
    BIND (?host AS ?child_uri).
    BIND (?comp_type AS ?parent_type_uri).
    BIND (?host_type AS ?child_type_uri).
    BIND (concat(?comp_label) AS ?parent_name).
    BIND (concat(?host_label) AS ?child_name).
    VALUES ?company_filter {&quot;Tutti&quot;}
    ?comp ubi-overall-m:companyFilter ?company_filter.
    ?host ubi-overall-m:companyFilter ?company_filter.

} UNION 
{
    #dagli host virtuali agli host fisici ospitanti
    VALUES ?root_name {&quot;As400&quot;}
    ?host ii-inf-m:hostedOnPhysicalHost ?host2.
    ?host ?relation ?host2.
    ?host2 rdfs:label ?host2_label.
    ?host rdfs:label ?host_label.
    ?host rdfs:label ?root_name.
    ?host rdf:type ?host_type.
    ?host_type rdfs:label ?parent_type.
    ?host2 rdf:type ?host2_type.
    ?host2_type rdfs:label ?child_type.
    ?relation rdfs:label ?relation_name.
    BIND (concat(?host_label) AS ?parent_name).
    BIND (concat(?host2_label) AS ?child_name).
    VALUES ?company_filter {&quot;Tutti&quot;}
    ?host2 ubi-overall-m:companyFilter ?company_filter.
    ?host ubi-overall-m:companyFilter ?company_filter.

} 
UNION 
  { 
    #dalle applicazioni ai componenti
    VALUES ?root_name {&quot;As400&quot;}
    ?app rdf:type ii-app-m:Application.
    ?app rdf:type ?app_type.
    ?app_type rdfs:label ?app_type_label.
    ?app ii-app-m:isComposedByComponent ?comp.
    ?app ?relation ?comp.
    ?relation rdfs:label ?relation_name.
    ?comp rdfs:label ?comp_label.
    ?comp rdf:type [rdfs:label ?comp_type_label].
    ?app rdfs:label ?app_label.
    ?comp ii-overall-m:runsOnHost ?host.
    ?host rdfs:label ?host_label.
    ?host rdfs:label ?root_name.
    BIND (?relation  AS ?relation_uri ).
    BIND (?app AS ?parent_uri).
    BIND (?comp AS ?child_uri).
    BIND (?app_type AS ?parent_type_uri).
    BIND (?comp_type AS ?child_type_uri).
    BIND (concat(?app_type_label) AS ?parent_type).
    BIND (concat(?comp_type_label) AS ?child_type).
    BIND (concat(?app_label) AS ?parent_name).
    BIND (concat(?comp_label) AS ?child_name).
    VALUES ?company_filter {&quot;Tutti&quot;}
    ?comp ubi-overall-m:companyFilter ?company_filter.
    ?app ubi-overall-m:companyFilter ?company_filter.
  }
UNION
  {
 #dalle risorse informatiche alle applicazioni
 ?ir rdf:type ubi-overall-m:InformaticResource.
    ?ir rdf:type ?ir_type.
    ?ir_type rdfs:label ?ir_type_label.
    VALUES ?root_name {&quot;As400&quot;}
    ?ir ubi-overall-m:containsApplication ?app.
    ?app rdf:type ?app_type.
    ?app_type rdfs:label ?app_type_label.
    ?ir ?relation ?app.
    ?relation rdfs:label ?relation_name.
    ?ir rdfs:label ?ir_label.
    ?app rdfs:label ?app_label.
    ?ir ubi-overall-m:containsApplication ?app.
    ?app ii-app-m:isComposedByComponent ?comp.
    ?comp ii-overall-m:runsOnHost ?host.
    ?host rdfs:label ?host_label.
    ?host rdfs:label ?root_name.
    
    BIND (?relation  AS ?relation_uri ).
    BIND (?ir AS ?parent_uri).
    BIND (?app AS ?child_uri).
    BIND (?ir_type AS ?parent_type_uri).
    BIND (?app_type AS ?child_type_uri).

    BIND (concat(?ir_type_label) AS ?parent_type).
    BIND (concat(?app_type_label) AS ?child_type).
    BIND (concat(?ir_label) AS ?parent_name).
    BIND (concat(?app_label) AS ?child_name).
    VALUES ?company_filter {&quot;Tutti&quot;}
    ?ir ubi-overall-m:companyFilter ?company_filter.
    ?app ubi-overall-m:companyFilter ?company_filter.
  } UNION {
    #dai processi alle risorse informatiche
    ?proc rdfs:label ?proc_label.
    ?proc rdf:type ?proc_type.
    ?proc_type rdfs:label ?proc_type_label.
    ?ir rdfs:label ?ir_label.
    ?ir rdf:type ?ir_type.
    ?ir_type rdfs:label ?ir_type_label.
    ?proc ?relation ?ir.
    ?relation rdfs:label ?relation_name.
    ?proc ubi-overall-m:involvesInformaticResource ?ir.
    ?ir ubi-overall-m:containsApplication ?app.
    ?app ii-app-m:isComposedByComponent ?comp.
    ?comp ii-overall-m:runsOnHost ?host.
    ?host rdfs:label ?host_label.
    ?host rdfs:label ?root_name.
    VALUES ?root_name {&quot;As400&quot;}

    BIND (?relation  AS ?relation_uri ).
    BIND (?proc AS ?parent_uri).
    BIND (?ir AS ?child_uri).
    BIND (?proc_type AS ?parent_type_uri).
    BIND (?ir_type AS ?child_type_uri).

    BIND (concat(?proc_type_label) AS ?parent_type).
    BIND (concat(?ir_type_label) AS ?child_type).
    BIND (concat(?proc_label) AS ?parent_name).
    BIND (concat(?ir_label) AS ?child_name).
    VALUES ?company_filter {&quot;Tutti&quot;}
    ?proc ubi-overall-m:companyFilter ?company_filter.
    ?ir ubi-overall-m:companyFilter ?company_filter.
}
UNION
  
    {
    #dai componenti ai cluster di questo host
    VALUES ?root_name {&quot;As400&quot;}
    ?comp rdf:type ii-app-m:ApplicationComponent.
    ?comp rdf:type [rdfs:label ?comp_type_label].
    ?comp ii-overall-m:runsOnCluster ?clust.
    ?clust ii-inf-m:isComposedOfHost ?host.
    ?clust rdfs:label ?clust_label.
    ?clust rdf:type [rdfs:label ?clust_type_label].
    ?comp ?relation ?clust.
    ?comp rdfs:label ?comp_label.
    ?host rdfs:label ?host_label.
    ?host rdfs:label ?root_name.
    ?host rdf:type [rdfs:label ?host_type_label].
    ?relation rdfs:label ?relation_name.
    BIND (concat(?comp_type_label) AS ?parent_type).
    BIND (concat(?clust_type_label) AS ?child_type).
    BIND (concat(?comp_label) AS ?parent_name).
    BIND (concat(?clust_label) AS ?child_name).
    VALUES ?company_filter {&quot;Tutti&quot;}
    ?comp ubi-overall-m:companyFilter ?company_filter.
    ?clust ubi-overall-m:companyFilter ?company_filter.
    } UNION
      {
    #dalle applicazioni ai componenti che girano sui cluster di questo host
    VALUES ?root_name {&quot;As400&quot;}
    ?app rdf:type ii-app-m:Application.
    ?app rdf:type ?app_type.
    ?app rdfs:label ?app_label.
    ?app_type rdfs:label ?app_type_label.
    ?app ii-app-m:isComposedByComponent ?comp.
    ?app ?relation ?comp.
    ?comp rdf:type ii-app-m:ApplicationComponent.
    ?comp rdf:type [rdfs:label ?comp_type_label].
    ?comp ii-overall-m:runsOnCluster ?clust.
    ?clust ii-inf-m:isComposedOfHost ?host.
    ?clust rdfs:label ?clust_label.
    ?clust rdf:type [rdfs:label ?clust_type_label].
    ?comp rdfs:label ?comp_label.
    ?host rdfs:label ?host_label.
    ?host rdfs:label ?root_name.
    ?host rdf:type [rdfs:label ?host_type_label].
    ?relation rdfs:label ?relation_name.
    BIND (concat(?app_type_label) AS ?parent_type).
    BIND (concat(?comp_type_label) AS ?child_type).
    BIND (concat(?app_label) AS ?parent_name).
    BIND (concat(?comp_label) AS ?child_name).
    VALUES ?company_filter {&quot;Tutti&quot;}
    ?comp ubi-overall-m:companyFilter ?company_filter.
    ?app ubi-overall-m:companyFilter ?company_filter.
    }
  UNION
      {
   #dalle risorse alle applicazioni che girano sui cluster di questo host
    VALUES ?root_name {&quot;As400&quot;}
     ?ir rdf:type ubi-overall-m:InformaticResource.
    ?ir rdfs:label ?ir_label.
    ?ir rdf:type [rdfs:label ?ir_type_label].
    ?ir ubi-overall-m:containsApplication ?app.
    ?app rdf:type ii-app-m:Application.
    ?app rdf:type ?app_type.
    ?app rdfs:label ?app_label.
    ?app_type rdfs:label ?app_type_label.
    ?app ii-app-m:isComposedByComponent ?comp.
    ?ir ?relation ?app.
    ?comp rdf:type ii-app-m:ApplicationComponent.
    ?comp rdf:type [rdfs:label ?comp_type_label].
    ?comp ii-overall-m:runsOnCluster ?clust.
    ?clust ii-inf-m:isComposedOfHost ?host.
    ?clust rdfs:label ?clust_label.
    ?clust rdf:type [rdfs:label ?clust_type_label].
    ?comp rdfs:label ?comp_label.
    ?host rdfs:label ?host_label.
    ?host rdfs:label ?root_name.
    ?host rdf:type [rdfs:label ?host_type_label].
    ?relation rdfs:label ?relation_name.
    BIND (concat(?ir_type_label) AS ?parent_type).
    BIND (concat(?app_type_label) AS ?child_type).
    BIND (concat(?ir_label) AS ?parent_name).
    BIND (concat(?app_label) AS ?child_name).
    VALUES ?company_filter {&quot;Tutti&quot;}
    ?ir ubi-overall-m:companyFilter ?company_filter.
    ?app ubi-overall-m:companyFilter ?company_filter.
    }
UNION {
#dai processi alle risorse informatiche che girano sui cluster di questo host
VALUES ?root_name {&quot;As400&quot;}
        ?proc rdfs:label ?proc_label.
    ?proc rdf:type ii-bus-m:BusinessProcess.
    ?proc rdf:type [rdfs:label ?proc_type_label].
     ?ir rdf:type ubi-overall-m:InformaticResource.
    ?ir rdfs:label ?ir_label.
    ?ir rdf:type [rdfs:label ?ir_type_label].
    ?ir ubi-overall-m:containsApplication ?app.
    ?app rdf:type ii-app-m:Application.
    ?app rdf:type ?app_type.
    ?app rdfs:label ?app_label.
    ?app_type rdfs:label ?app_type_label.
    ?app ii-app-m:isComposedByComponent ?comp.
    ?proc ?relation ?ir.
    ?comp rdf:type ii-app-m:ApplicationComponent.
    ?comp rdf:type [rdfs:label ?comp_type_label].
    ?comp ii-overall-m:runsOnCluster ?clust.
    ?clust ii-inf-m:isComposedOfHost ?host.
    ?clust rdfs:label ?clust_label.
    ?clust rdf:type [rdfs:label ?clust_type_label].
    ?comp rdfs:label ?comp_label.
    ?host rdfs:label ?host_label.
    ?host rdfs:label ?root_name.
    ?host rdf:type [rdfs:label ?host_type_label].
    ?relation rdfs:label ?relation_name.
    BIND (concat(?proc_type_label) AS ?parent_type).
    BIND (concat(?ir_type_label) AS ?child_type).
    BIND (concat(?proc_label) AS ?parent_name).
    BIND (concat(?ir_label) AS ?child_name).
    VALUES ?company_filter {&quot;Tutti&quot;}
    ?proc ubi-overall-m:companyFilter ?company_filter.
    ?ir ubi-overall-m:companyFilter ?company_filter.
} UNION {
    #dai cluster agli host
      VALUES ?root_name {&quot;As400&quot;}
    ?comp rdf:type ii-app-m:ApplicationComponent.
    ?comp rdf:type [rdfs:label ?comp_type_label].
    ?comp ii-overall-m:runsOnCluster ?clust.
    ?clust ii-inf-m:isComposedOfHost ?host.
    ?clust ii-inf-m:isComposedOfHost ?host2.
    ?clust rdfs:label ?clust_label.
    ?clust rdf:type [rdfs:label ?clust_type_label].
    ?clust ?relation ?host.
    ?comp rdfs:label ?comp_label.
    ?host rdfs:label ?host_label.
    ?host2 rdfs:label ?root_name.
    ?host rdf:type [rdfs:label ?host_type_label].
    ?relation rdfs:label ?relation_name.
    BIND (concat(?clust_type_label) AS ?parent_type).
    BIND (concat(?host_type_label) AS ?child_type).
    BIND (concat(?clust_label) AS ?parent_name).
    BIND (concat(?host_label) AS ?child_name).
    VALUES ?company_filter {&quot;Tutti&quot;}
    ?clust ubi-overall-m:companyFilter ?company_filter.
    ?host ubi-overall-m:companyFilter ?company_filter.
  }
}"></div></div>
</body>
</html>